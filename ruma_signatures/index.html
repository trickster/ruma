<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Digital signatures according to the Matrix specification."><meta name="keywords" content="rust, rustlang, rust-lang, ruma_signatures"><title>ruma_signatures - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="https://www.ruma.io/favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../ruma_signatures/index.html'><div class='logo-container'><img src='https://www.ruma.io/images/logo.png' alt='logo'></div></a><p class="location">Crate ruma_signatures</p><div class="block version"><p>Version 0.7.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all ruma_signatures's items</p></a><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="ruma_signatures" data-ty="mod" data-relpath="../"></div></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">ruma_signatures</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/ruma_signatures/lib.rs.html#1-488" title="goto source code">[src]</a></span></h1><div class="docblock"><p>Digital signatures according to the <a href="https://matrix.org/">Matrix</a> specification.</p>
<p>Digital signatures are used by Matrix homeservers to verify the authenticity of events in the
Matrix system, as well as requests between homeservers for federation. Each homeserver has one
or more signing key pairs (sometimes referred to as “verify keys”) which it uses to sign all
events and federation requests. Matrix clients and other Matrix homeservers can ask the
homeserver for its public keys and use those keys to verify the signed data.</p>
<p>Each signing key pair has an identifier, which consists of the name of the digital signature
algorithm it uses and a “version” string, separated by a colon. The version is an arbitrary
identifier used to distinguish key pairs using the same algorithm from the same homeserver.</p>
<p>Arbitrary JSON objects can be signed as well as JSON representations of Matrix events. In both
cases, the signatures are stored within the JSON object itself under a <code>signatures</code> key. Events
are also required to contain hashes of their content, which are similarly stored within the
hashed JSON object under a <code>hashes</code> key.</p>
<p>In JSON representations, both signatures and hashes appear as Base64-encoded strings, using the
standard character set, without padding.</p>
<h1 id="signing-and-hashing" class="section-header"><a href="#signing-and-hashing">Signing and hashing</a></h1>
<p>To sign an arbitrary JSON object, use the <code>sign_json</code> function. See the documentation of this
function for more details and a full example of use.</p>
<p>Signing an event uses a more complicated process than signing arbitrary JSON, because events can
be redacted, and signatures need to remain valid even if data is removed from an event later.
Homeservers are required to generate hashes of event contents as well as signing events before
exchanging them with other homeservers. Although the algorithm for hashing and signing an event
is more complicated than for signing arbitrary JSON, the interface to a user of ruma-signatures
is the same. To hash and sign an event, use the <code>hash_and_sign_event</code> function. See the
documentation of this function for more details and a full example of use.</p>
<h1 id="verifying-signatures-and-hashes" class="section-header"><a href="#verifying-signatures-and-hashes">Verifying signatures and hashes</a></h1>
<p>When a homeserver receives data from another homeserver via the federation, it’s necessary to
verify the authenticity and integrity of the data by verifying their signatures.</p>
<p>To verify a signature on arbitrary JSON, use the <code>verify_json</code> function. To verify the
signatures and hashes on an event, use the <code>verify_event</code> function. See the documentation for
these respective functions for more details and full examples of use.</p>
</div><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.Ed25519KeyPair.html" title="ruma_signatures::Ed25519KeyPair struct">Ed25519KeyPair</a></td><td class="docblock-short"><p>An Ed25519 key pair.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Error.html" title="ruma_signatures::Error struct">Error</a></td><td class="docblock-short"><p>An error produced when ruma-signatures operations fail.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Signature.html" title="ruma_signatures::Signature struct">Signature</a></td><td class="docblock-short"><p>A digital signature.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.Algorithm.html" title="ruma_signatures::Algorithm enum">Algorithm</a></td><td class="docblock-short"><p>The algorithm used for signing data.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.CanonicalJsonError.html" title="ruma_signatures::CanonicalJsonError enum">CanonicalJsonError</a></td><td class="docblock-short"><p>The set of possible errors when serializing to canonical JSON.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.CanonicalJsonValue.html" title="ruma_signatures::CanonicalJsonValue enum">CanonicalJsonValue</a></td><td class="docblock-short"><p>Represents a canonical JSON value as per the Matrix specification.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Verified.html" title="ruma_signatures::Verified enum">Verified</a></td><td class="docblock-short"><p>A value returned when an event is successfully verified.</p>
</td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.KeyPair.html" title="ruma_signatures::KeyPair trait">KeyPair</a></td><td class="docblock-short"><p>A cryptographic key pair for digitally signing data.</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.canonical_json.html" title="ruma_signatures::canonical_json fn">canonical_json</a></td><td class="docblock-short"><p>Converts an event into the <a href="https://matrix.org/docs/spec/appendices#canonical-json">canonical</a> string form.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.content_hash.html" title="ruma_signatures::content_hash fn">content_hash</a></td><td class="docblock-short"><p>Creates a <em>content hash</em> for an event.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.hash_and_sign_event.html" title="ruma_signatures::hash_and_sign_event fn">hash_and_sign_event</a></td><td class="docblock-short"><p>Hashes and signs an event and adds the hash and signature to objects under the keys <code>hashes</code> and
<code>signatures</code>, respectively.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.redact.html" title="ruma_signatures::redact fn">redact</a></td><td class="docblock-short"><p>Redacts an event using the rules specified in the Matrix client-server specification.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.reference_hash.html" title="ruma_signatures::reference_hash fn">reference_hash</a></td><td class="docblock-short"><p>Creates a <em>reference hash</em> for an event.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.sign_json.html" title="ruma_signatures::sign_json fn">sign_json</a></td><td class="docblock-short"><p>Signs an arbitrary JSON object and adds the signature to an object under the key <code>signatures</code>.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.verify_event.html" title="ruma_signatures::verify_event fn">verify_event</a></td><td class="docblock-short"><p>Verifies that the signed event contains all the required valid signatures.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.verify_json.html" title="ruma_signatures::verify_json fn">verify_json</a></td><td class="docblock-short"><p>Uses a set of public keys to verify a signed JSON object.</p>
</td></tr></table><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<table><tr class="module-item"><td><a class="type" href="type.CanonicalJsonObject.html" title="ruma_signatures::CanonicalJsonObject type">CanonicalJsonObject</a></td><td class="docblock-short"><p>The inner type of <code>CanonicalJsonValue::Object</code>.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.PublicKeyMap.html" title="ruma_signatures::PublicKeyMap type">PublicKeyMap</a></td><td class="docblock-short"><p>A map from entity names to sets of public keys for that entity.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.PublicKeySet.html" title="ruma_signatures::PublicKeySet type">PublicKeySet</a></td><td class="docblock-short"><p>A set of public keys for a single homeserver.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="ruma_signatures" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script></body></html>